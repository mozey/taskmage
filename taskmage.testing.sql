-- To create / restore SQLite dumps
-- https://www.sqlite.org/cli.html
-- echo '.dump' | sqlite3 taskmage.testing.db | gzip -c >taskmage.testing.gz
-- zcat taskmage.testing.gz | sqlite3 taskmage.testing.db
-- gunzip taskmage.testing.gz
-- cat taskmage.testing.sql | sqlite3 taskmage.testing.db

PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE task (
	uuid VARCHAR NOT NULL, 
	project VARCHAR, 
	urgency VARCHAR, 
	description VARCHAR, 
	modified DATETIME, 
	completed DATETIME, 
	PRIMARY KEY (uuid)
);

INSERT INTO "task" VALUES('11111111-1111-1111-1111-111111111111','Project 1','m','Completed task','2015-11-28 15:16:14.729291','2015-11-03 09:21:00.000000');
INSERT INTO "task" VALUES('11111111-1111-1111-1111-111111111112','Project 1','l','Pending task','2015-11-28 15:17:14.729291',None);
INSERT INTO "task" VALUES('11111111-1111-1111-1111-111111111113','Project 1','h','Another pending task','2015-11-28 15:18:14.729291',None);

INSERT INTO "task" VALUES('11111111-1111-1111-1111-111111111114','Project 2','m','Completed task','2015-11-28 15:19:14.729291','2015-11-03 12:21:00.000000');
INSERT INTO "task" VALUES('11111111-1111-1111-1111-111111111115','Project 2','l','Pending task','2015-11-28 15:20:14.729291',None);
INSERT INTO "task" VALUES('11111111-1111-1111-1111-111111111116','Project 2','h','Another pending task','2015-11-28 15:21:14.729291',None);

CREATE TABLE tag (
	uuid VARCHAR NOT NULL, 
	tag VARCHAR, 
	modified DATETIME, 
	PRIMARY KEY (uuid)
);
CREATE TABLE pointer (
	id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 
	task_uuid VARCHAR, 
	FOREIGN KEY(task_uuid) REFERENCES task (uuid)
);
INSERT INTO "pointer" VALUES(1,'11111111-1111-1111-1111-111111111111');
INSERT INTO "pointer" VALUES(2,'11111111-1111-1111-1111-111111111112');
INSERT INTO "pointer" VALUES(3,'11111111-1111-1111-1111-111111111113');
INSERT INTO "pointer" VALUES(4,'11111111-1111-1111-1111-111111111114');
INSERT INTO "pointer" VALUES(5,'11111111-1111-1111-1111-111111111115');
INSERT INTO "pointer" VALUES(6,'11111111-1111-1111-1111-111111111116');
-- INSERT INTO "pointer" VALUES(7,'11111111-1111-1111-1111-111111111117');
-- INSERT INTO "pointer" VALUES(8,'11111111-1111-1111-1111-111111111118');
-- INSERT INTO "pointer" VALUES(9,'11111111-1111-1111-1111-111111111119');
-- INSERT INTO "pointer" VALUES(10,'11111111-1111-1111-1111-11111111110');

CREATE TABLE task_tag (
	uuid VARCHAR NOT NULL, 
	modified DATETIME, 
	tag_uuid VARCHAR, 
	task_uuid VARCHAR, 
	PRIMARY KEY (uuid), 
	FOREIGN KEY(tag_uuid) REFERENCES tag (uuid), 
	FOREIGN KEY(task_uuid) REFERENCES task (uuid)
);

CREATE TABLE entry (
	uuid VARCHAR NOT NULL, 
	sheet VARCHAR, 
	start_time DATETIME, 
	end_time DATETIME, 
	modified DATETIME, 
	task_uuid VARCHAR, 
	PRIMARY KEY (uuid), 
	FOREIGN KEY(task_uuid) REFERENCES task (uuid)
);
INSERT INTO "entry" VALUES('22222222-2222-2222-2222-222222222221','2015-11','2015-11-01 15:20:00.000000','2015-11-01 17:05:00.000000','2015-11-28 15:16:14.741051','11111111-1111-1111-1111-111111111111');
INSERT INTO "entry" VALUES('22222222-2222-2222-2222-222222222222','2015-11','2015-11-02 09:25:00.000000','2015-11-02 12:00:00.000000','2015-11-28 15:16:14.741242','11111111-1111-1111-1111-111111111111');

DELETE FROM sqlite_sequence;
INSERT INTO "sqlite_sequence" VALUES('pointer',10);
CREATE INDEX ix_entry_sheet ON entry (sheet);
COMMIT;
